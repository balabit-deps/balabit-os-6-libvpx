Backport of:

From 6a7c84a2449dcc70de2525df209afea908622399 Mon Sep 17 00:00:00 2001
From: James Zern <jzern@google.com>
Date: Fri, 7 Jun 2019 15:06:29 -0700
Subject: [PATCH] update libwebm to libwebm-1.0.0.27-361-g81de00c

81de00c Check there is only one settings per ContentCompression
5623013 Fixes a double free in ContentEncoding
93b2ba0 mkvparser: quiet static analysis warnings

Change-Id: Ieaa562ef2f10075381bd856388e6b29f97ca2746
---
 third_party/libwebm/README.libvpx          | 2 +-
 third_party/libwebm/mkvparser/mkvparser.cc | 9 +++++++++
 2 files changed, 10 insertions(+), 1 deletion(-)

--- a/third_party/libwebm/mkvparser.cpp
+++ b/third_party/libwebm/mkvparser.cpp
@@ -4234,6 +4234,7 @@ long ContentEncoding::ParseContentEncodi
         new (std::nothrow) ContentEncryption*[encryption_count];
     if (!encryption_entries_) {
       delete[] compression_entries_;
+      compression_entries_ = NULL;
       return -1;
     }
     encryption_entries_end_ = encryption_entries_;
@@ -4265,6 +4266,7 @@ long ContentEncoding::ParseContentEncodi
         delete compression;
         return status;
       }
+      assert(compression_count > 0);
       *compression_entries_end_++ = compression;
     } else if (id == mkvmuxer::kMkvContentEncryption) {
       ContentEncryption* const encryption =
@@ -4277,6 +4279,7 @@ long ContentEncoding::ParseContentEncodi
         delete encryption;
         return status;
       }
+      assert(encryption_count > 0);
       *encryption_entries_end_++ = encryption;
     }
 
@@ -4329,6 +4332,12 @@ long ContentEncoding::ParseCompressionEn
         return status;
       }
 
+      // There should be only one settings element per content compression.
+      if (compression->settings != NULL) {
+        delete[] buf;
+        return E_FILE_FORMAT_INVALID;
+      }
+
       compression->settings = buf;
       compression->settings_len = buflen;
     }
